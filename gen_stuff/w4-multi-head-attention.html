<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Â§öÈ†≠Ê≥®ÊÑèÂäõË¶ñË¶∫Âåñ</title>
    <style>
        :root {
            --bg-color: #F4F2EF;
            --text-color: #5a5a5a;
            --accent-color: #78785b;
            --line-color: #d1d1c2;
            --highlight-color: #8c867b;
            --color-primary: rgba(120, 120, 91, 0.7);
            --color-secondary: rgba(163, 163, 128, 0.7);
            --color-accent: rgba(180, 120, 120, 0.7);
            --color-success: rgba(120, 150, 120, 0.7);
            --color-info: rgba(120, 140, 160, 0.7);
            --color-warning: rgba(160, 140, 180, 0.7);
            --color-earth: rgba(139, 125, 107, 0.7);
            --color-stone: rgba(152, 144, 136, 0.7);
            --color-moss: rgba(108, 128, 108, 0.7);
            --color-mist: rgba(168, 160, 152, 0.7);
        }

        body {
            margin: 0;
            padding: 20px;
            background-color: var(--bg-color);
            font-family: 'Calibri', 'Noto Sans TC', sans-serif;
            color: var(--text-color);
            overflow-x: auto;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: var(--accent-color);
            margin-bottom: 30px;
            font-size: 2.5rem;
        }

        .controls {
            text-align: center;
            margin-bottom: 30px;
        }

        .control-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 0 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
        }

        .control-btn:hover {
            background: var(--highlight-color);
        }

        .control-btn.active {
            background: var(--color-accent);
        }

        .visualization {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
            margin: 30px 0;
        }

        .input-section {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            border: 2px solid var(--line-color);
            min-width: 400px;
        }

        .input-tokens {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .token {
            background: var(--color-primary);
            color: white;
            padding: 8px 12px;
            border-radius: 5px;
            font-weight: bold;
            min-width: 60px;
            text-align: center;
            transition: transform 0.3s;
        }

        .token:hover {
            transform: scale(1.1);
        }

        .heads-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .head {
            background: rgba(255, 255, 255, 0.5);
            border: 2px solid var(--line-color);
            border-radius: 10px;
            padding: 15px;
            min-width: 200px;
            text-align: center;
            transition: all 0.3s;
        }

        .head.active {
            border-color: var(--color-accent);
            background: rgba(180, 120, 120, 0.1);
            transform: scale(1.05);
        }

        .head-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--accent-color);
        }

        .head-description {
            font-size: 0.9rem;
            color: var(--text-color);
            margin-bottom: 15px;
        }

        .attention-matrix {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px;
            margin: 10px 0;
        }

        .attention-cell {
            width: 30px;
            height: 30px;
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
            color: white;
            transition: all 0.3s;
        }

        .attention-cell.high {
            background: var(--color-accent);
        }

        .attention-cell.medium {
            background: var(--color-secondary);
        }

        .attention-cell.low {
            background: var(--color-mist);
        }

        .output-section {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            border: 2px solid var(--line-color);
            min-width: 400px;
        }

        .concatenation {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .head-output {
            background: var(--color-info);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
            min-width: 80px;
            text-align: center;
        }

        .concat-arrow {
            font-size: 1.5rem;
            color: var(--accent-color);
            font-weight: bold;
        }

        .final-output {
            background: var(--color-success);
            color: white;
            padding: 15px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 1.1rem;
            margin-top: 15px;
        }

        .explanation {
            background: rgba(255, 255, 255, 0.5);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent-color);
        }

        .step {
            margin: 10px 0;
            padding: 10px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 5px;
            border-left: 3px solid var(--color-primary);
        }

        .step.active {
            background: rgba(120, 120, 91, 0.1);
            border-left-color: var(--color-accent);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 1s infinite;
        }

        @media (max-width: 768px) {
            .heads-container {
                flex-direction: column;
                align-items: center;
            }

            .head {
                min-width: 250px;
            }

            .input-tokens {
                gap: 5px;
            }

            .token {
                min-width: 50px;
                padding: 6px 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Â§öÈ†≠Ê≥®ÊÑèÂäõÊ©üÂà∂Ë¶ñË¶∫Âåñ</h1>

        <div class="controls">
            <button class="control-btn active" onclick="startAnimation()">ÈñãÂßãÂãïÁï´</button>
            <button class="control-btn" onclick="resetAnimation()">ÈáçÁΩÆ</button>
            <button class="control-btn" onclick="toggleStepMode()">ÈÄêÊ≠•Ê®°Âºè</button>
        </div>

        <div class="visualization">
            <!-- Ëº∏ÂÖ•ÈÉ®ÂàÜ -->
            <div class="input-section">
                <h3>Ëº∏ÂÖ•Â∫èÂàó</h3>
                <p>ÁØÑ‰æãÂè•Â≠êÔºö„ÄåÊàë ÂñúÊ≠° ÂêÉ ËòãÊûú„Äç</p>
                <div class="input-tokens">
                    <div class="token" data-token="Êàë">Êàë</div>
                    <div class="token" data-token="ÂñúÊ≠°">ÂñúÊ≠°</div>
                    <div class="token" data-token="ÂêÉ">ÂêÉ</div>
                    <div class="token" data-token="ËòãÊûú">ËòãÊûú</div>
                </div>
            </div>

            <!-- Â§öÂÄãÊ≥®ÊÑèÂäõÈ†≠ -->
            <div class="heads-container">
                <div class="head" data-head="0">
                    <div class="head-title">üë®‚Äçüè´ Â∞àÂÆ∂ A</div>
                    <div class="head-description">ÊñáÊ≥ïÁµêÊßãÂ∞àÂÆ∂</div>
                    <div class="attention-matrix">
                        <div class="attention-cell high" title="Êàë‚ÜíÊàë">0.9</div>
                        <div class="attention-cell low" title="Êàë‚ÜíÂñúÊ≠°">0.1</div>
                        <div class="attention-cell low" title="Êàë‚ÜíÂêÉ">0.0</div>
                        <div class="attention-cell low" title="Êàë‚ÜíËòãÊûú">0.0</div>
                        <div class="attention-cell low" title="ÂñúÊ≠°‚ÜíÊàë">0.2</div>
                        <div class="attention-cell high" title="ÂñúÊ≠°‚ÜíÂñúÊ≠°">0.8</div>
                        <div class="attention-cell low" title="ÂñúÊ≠°‚ÜíÂêÉ">0.0</div>
                        <div class="attention-cell low" title="ÂñúÊ≠°‚ÜíËòãÊûú">0.0</div>
                        <div class="attention-cell low" title="ÂêÉ‚ÜíÊàë">0.1</div>
                        <div class="attention-cell medium" title="ÂêÉ‚ÜíÂñúÊ≠°">0.3</div>
                        <div class="attention-cell high" title="ÂêÉ‚ÜíÂêÉ">0.6</div>
                        <div class="attention-cell low" title="ÂêÉ‚ÜíËòãÊûú">0.0</div>
                        <div class="attention-cell low" title="ËòãÊûú‚ÜíÊàë">0.0</div>
                        <div class="attention-cell low" title="ËòãÊûú‚ÜíÂñúÊ≠°">0.0</div>
                        <div class="attention-cell low" title="ËòãÊûú‚ÜíÂêÉ">0.2</div>
                        <div class="attention-cell high" title="ËòãÊûú‚ÜíËòãÊûú">0.8</div>
                    </div>
                </div>

                <div class="head" data-head="1">
                    <div class="head-title">üß† Â∞àÂÆ∂ B</div>
                    <div class="head-description">Ë™ûÊÑèÈóúËÅØÂ∞àÂÆ∂</div>
                    <div class="attention-matrix">
                        <div class="attention-cell high" title="Êàë‚ÜíÊàë">0.7</div>
                        <div class="attention-cell medium" title="Êàë‚ÜíÂñúÊ≠°">0.2</div>
                        <div class="attention-cell low" title="Êàë‚ÜíÂêÉ">0.1</div>
                        <div class="attention-cell low" title="Êàë‚ÜíËòãÊûú">0.0</div>
                        <div class="attention-cell medium" title="ÂñúÊ≠°‚ÜíÊàë">0.4</div>
                        <div class="attention-cell high" title="ÂñúÊ≠°‚ÜíÂñúÊ≠°">0.5</div>
                        <div class="attention-cell low" title="ÂñúÊ≠°‚ÜíÂêÉ">0.1</div>
                        <div class="attention-cell low" title="ÂñúÊ≠°‚ÜíËòãÊûú">0.0</div>
                        <div class="attention-cell low" title="ÂêÉ‚ÜíÊàë">0.1</div>
                        <div class="attention-cell medium" title="ÂêÉ‚ÜíÂñúÊ≠°">0.3</div>
                        <div class="attention-cell high" title="ÂêÉ‚ÜíÂêÉ">0.6</div>
                        <div class="attention-cell low" title="ÂêÉ‚ÜíËòãÊûú">0.0</div>
                        <div class="attention-cell low" title="ËòãÊûú‚ÜíÊàë">0.0</div>
                        <div class="attention-cell low" title="ËòãÊûú‚ÜíÂñúÊ≠°">0.1</div>
                        <div class="attention-cell medium" title="ËòãÊûú‚ÜíÂêÉ">0.2</div>
                        <div class="attention-cell high" title="ËòãÊûú‚ÜíËòãÊûú">0.7</div>
                    </div>
                </div>

                <div class="head" data-head="2">
                    <div class="head-title">üîó Â∞àÂÆ∂ C</div>
                    <div class="head-description">ÈÇèËºØÈ†ÜÂ∫èÂ∞àÂÆ∂</div>
                    <div class="attention-matrix">
                        <div class="attention-cell high" title="Êàë‚ÜíÊàë">0.8</div>
                        <div class="attention-cell low" title="Êàë‚ÜíÂñúÊ≠°">0.1</div>
                        <div class="attention-cell low" title="Êàë‚ÜíÂêÉ">0.1</div>
                        <div class="attention-cell low" title="Êàë‚ÜíËòãÊûú">0.0</div>
                        <div class="attention-cell low" title="ÂñúÊ≠°‚ÜíÊàë">0.1</div>
                        <div class="attention-cell high" title="ÂñúÊ≠°‚ÜíÂñúÊ≠°">0.7</div>
                        <div class="attention-cell medium" title="ÂñúÊ≠°‚ÜíÂêÉ">0.2</div>
                        <div class="attention-cell low" title="ÂñúÊ≠°‚ÜíËòãÊûú">0.0</div>
                        <div class="attention-cell low" title="ÂêÉ‚ÜíÊàë">0.0</div>
                        <div class="attention-cell low" title="ÂêÉ‚ÜíÂñúÊ≠°">0.1</div>
                        <div class="attention-cell high" title="ÂêÉ‚ÜíÂêÉ">0.6</div>
                        <div class="attention-cell medium" title="ÂêÉ‚ÜíËòãÊûú">0.3</div>
                        <div class="attention-cell low" title="ËòãÊûú‚ÜíÊàë">0.0</div>
                        <div class="attention-cell low" title="ËòãÊûú‚ÜíÂñúÊ≠°">0.0</div>
                        <div class="attention-cell low" title="ËòãÊûú‚ÜíÂêÉ">0.1</div>
                        <div class="attention-cell high" title="ËòãÊûú‚ÜíËòãÊûú">0.9</div>
                    </div>
                </div>
            </div>

            <!-- Ëº∏Âá∫ÈÉ®ÂàÜ -->
            <div class="output-section">
                <h3>ü§ù ‰∏â‰ΩçÂ∞àÂÆ∂Êï¥ÂêàÁµêÊûú</h3>
                <div class="concatenation">
                    <div class="head-output">üë®‚Äçüè´ ÊñáÊ≥ïÂ∞àÂÆ∂</div>
                    <div class="concat-arrow">‚äï</div>
                    <div class="head-output">üß† Ë™ûÊÑèÂ∞àÂÆ∂</div>
                    <div class="concat-arrow">‚äï</div>
                    <div class="head-output">üîó ÈÇèËºØÂ∞àÂÆ∂</div>
                </div>
                <div class="final-output">„ÄåËòãÊûú„Äç= ÊñáÊ≥ïË≥ìË™û + Ë™ûÊÑèÈ£üÁâ© + ÈÇèËºØÂ∞çË±°</div>
            </div>
        </div>

        <div class="explanation">
            <h3>„ÄåÂ§ö‰ΩçÂ∞àÂÆ∂ÁúãÊõ∏„ÄçÁöÑÊï∏Â≠∏Ë°®Á§∫</h3>

            <div class="step" data-step="1">
                <strong>üìö ÊÉÖÂ¢ÉÔºö</strong> Âè•Â≠ê„ÄåÊàë ÂñúÊ≠° ÂêÉ ËòãÊûú„ÄçÈúÄË¶Å‰∏â‰ΩçÂ∞àÂÆ∂ÂêåÊôÇÂàÜÊûê
            </div>

            <div class="step" data-step="2">
                <strong>üë®‚Äçüè´ Â∞àÂÆ∂ AÔºàÊñáÊ≥ïÁµêÊßãÔºâÔºö</strong><br>
                <div style="margin-left: 1rem; font-family: monospace; background: rgba(120, 120, 91, 0.1); padding: 10px; border-radius: 5px;">
                    Q<sub>A</sub> = [Êàë, ÂñúÊ≠°, ÂêÉ, ËòãÊûú] √ó W<sub>A</sub><sup>Q</sup><br>
                    K<sub>A</sub> = [Êàë, ÂñúÊ≠°, ÂêÉ, ËòãÊûú] √ó W<sub>A</sub><sup>K</sup><br>
                    <strong>Â∞àÊ≥®Ôºö</strong>„ÄåÂñúÊ≠°„Äç‚Üí„ÄåÊàë„ÄçÔºà‰∏ªË™ûÈóú‰øÇÔºâ„ÄÅ„ÄåÂêÉ„Äç‚Üí„ÄåËòãÊûú„ÄçÔºàÂãïË≥ìÈóú‰øÇÔºâ
                </div>
            </div>

            <div class="step" data-step="3">
                <strong>üß† Â∞àÂÆ∂ BÔºàË™ûÊÑèÈóúËÅØÔºâÔºö</strong><br>
                <div style="margin-left: 1rem; font-family: monospace; background: rgba(163, 163, 128, 0.1); padding: 10px; border-radius: 5px;">
                    Q<sub>B</sub> = [Êàë, ÂñúÊ≠°, ÂêÉ, ËòãÊûú] √ó W<sub>B</sub><sup>Q</sup><br>
                    K<sub>B</sub> = [Êàë, ÂñúÊ≠°, ÂêÉ, ËòãÊûú] √ó W<sub>B</sub><sup>K</sup><br>
                    <strong>Â∞àÊ≥®Ôºö</strong>„ÄåÂñúÊ≠°„Äç‚Üî„ÄåÂêÉ„ÄçÔºàÊÉÖÊÑüÂãï‰ΩúÔºâ„ÄÅ„ÄåÂêÉ„Äç‚Üî„ÄåËòãÊûú„ÄçÔºàÂãï‰ΩúÂ∞çË±°Ôºâ
                </div>
            </div>

            <div class="step" data-step="4">
                <strong>üîó Â∞àÂÆ∂ CÔºàÈÇèËºØÈ†ÜÂ∫èÔºâÔºö</strong><br>
                <div style="margin-left: 1rem; font-family: monospace; background: rgba(180, 120, 120, 0.1); padding: 10px; border-radius: 5px;">
                    Q<sub>C</sub> = [Êàë, ÂñúÊ≠°, ÂêÉ, ËòãÊûú] √ó W<sub>C</sub><sup>Q</sup><br>
                    K<sub>C</sub> = [Êàë, ÂñúÊ≠°, ÂêÉ, ËòãÊûú] √ó W<sub>C</sub><sup>K</sup><br>
                    <strong>Â∞àÊ≥®Ôºö</strong>„ÄåÊàë„Äç‚Üí„ÄåÂñúÊ≠°„Äç‚Üí„ÄåÂêÉ„Äç‚Üí„ÄåËòãÊûú„ÄçÔºàÊôÇÈñìÈ†ÜÂ∫èÔºâ
                </div>
            </div>

            <div class="step" data-step="5">
                <strong>ü§ù Êï¥ÂêàÁµêÊûúÔºö</strong><br>
                <div style="margin-left: 1rem; font-family: monospace; background: rgba(120, 150, 120, 0.1); padding: 10px; border-radius: 5px;">
                    MultiHead = Concat(Â∞àÂÆ∂AËº∏Âá∫, Â∞àÂÆ∂BËº∏Âá∫, Â∞àÂÆ∂CËº∏Âá∫) √ó W<sup>O</sup><br>
                    <strong>ÁµêÊûúÔºö</strong>„ÄåËòãÊûú„Äç= ÊñáÊ≥ï‰∏äÁöÑË≥ìË™û + Ë™ûÊÑè‰∏äÁöÑÈ£üÁâ© + ÈÇèËºØ‰∏äÁöÑÂãï‰ΩúÂ∞çË±°
                </div>
            </div>
        </div>
    </div>

    <script>
        let animationInterval;
        let currentStep = 0;
        let isStepMode = false;

        function startAnimation() {
            resetAnimation();
            animateMultiHeadAttention();
        }

        function resetAnimation() {
            // Ê∏ÖÈô§ÊâÄÊúâÂãïÁï´ÁãÄÊÖã
            document.querySelectorAll('.head').forEach(head => {
                head.classList.remove('active', 'pulse');
            });
            document.querySelectorAll('.step').forEach(step => {
                step.classList.remove('active');
            });
            document.querySelectorAll('.attention-cell').forEach(cell => {
                cell.classList.remove('pulse');
            });

            if (animationInterval) {
                clearInterval(animationInterval);
            }
            currentStep = 0;
        }

        function toggleStepMode() {
            isStepMode = !isStepMode;
            const btn = event.target;
            btn.classList.toggle('active');
            btn.textContent = isStepMode ? 'ÈÄ£Á∫åÊ®°Âºè' : 'ÈÄêÊ≠•Ê®°Âºè';
        }

        function animateMultiHeadAttention() {
            const steps = [
                () => highlightStep(1),
                () => highlightExperts(),
                () => highlightExpertAnalysis(),
                () => highlightExpertCollaboration(),
                () => highlightFinalIntegration()
            ];

            if (isStepMode) {
                // ÈÄêÊ≠•Ê®°ÂºèÔºöÈªûÊìäÂàáÊèõ
                document.addEventListener('click', function nextStep() {
                    if (currentStep < steps.length) {
                        steps[currentStep]();
                        currentStep++;
                    } else {
                        document.removeEventListener('click', nextStep);
                    }
                });
            } else {
                // ÈÄ£Á∫åÊ®°ÂºèÔºöËá™ÂãïÊí≠Êîæ
                let stepIndex = 0;
                animationInterval = setInterval(() => {
                    if (stepIndex < steps.length) {
                        steps[stepIndex]();
                        stepIndex++;
                    } else {
                        clearInterval(animationInterval);
                        // 3ÁßíÂæåÈáçÊñ∞ÈñãÂßã
                        setTimeout(() => {
                            if (!isStepMode) {
                                animateMultiHeadAttention();
                            }
                        }, 3000);
                    }
                }, 2000);
            }
        }

        function highlightStep(stepNumber) {
            document.querySelectorAll('.step').forEach(step => {
                step.classList.remove('active');
            });
            document.querySelector(`[data-step="${stepNumber}"]`).classList.add('active');
        }

        function highlightExperts() {
            document.querySelectorAll('.head').forEach((head, index) => {
                setTimeout(() => {
                    head.classList.add('active', 'pulse');
                }, index * 500);
            });
            highlightStep(2);
        }

        function highlightExpertAnalysis() {
            document.querySelectorAll('.attention-cell').forEach((cell, index) => {
                setTimeout(() => {
                    cell.classList.add('pulse');
                }, index * 50);
            });
            highlightStep(3);
        }

        function highlightExpertCollaboration() {
            document.querySelectorAll('.head-output').forEach((output, index) => {
                setTimeout(() => {
                    output.classList.add('pulse');
                }, index * 300);
            });
            document.querySelectorAll('.concat-arrow').forEach((arrow, index) => {
                setTimeout(() => {
                    arrow.classList.add('pulse');
                }, index * 300 + 150);
            });
            highlightStep(4);
        }

        function highlightFinalIntegration() {
            setTimeout(() => {
                document.querySelector('.final-output').classList.add('pulse');
            }, 500);
            highlightStep(5);
        }

        // ÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', () => {
            // Ê∑ªÂä†‰∫íÂãïÊïàÊûú
            document.querySelectorAll('.token').forEach(token => {
                token.addEventListener('mouseenter', function() {
                    this.style.transform = 'scale(1.2)';
                    this.style.zIndex = '10';
                });
                token.addEventListener('mouseleave', function() {
                    this.style.transform = 'scale(1)';
                    this.style.zIndex = '1';
                });
            });

            document.querySelectorAll('.head').forEach(head => {
                head.addEventListener('click', function() {
                    this.classList.toggle('active');
                });
            });
        });
    </script>
</body>
</html>
